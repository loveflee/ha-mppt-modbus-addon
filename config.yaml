#config.yaml
name: "MPPT Modbus MQTT Poller"
version: "1.0.1"
slug: "mppt_modbus_mqtt_poller"
description: "é€é Modbus gateway è®€å– MPPT è³‡æ–™ä¸¦ç™¼ä½ˆåˆ° MQTTï¼Œæä¾›çµ¦ Home Assistant ä½¿ç”¨ã€‚"
url: "https://github.com/loveflee/ha-mppt-modbus-addon"
documentation: "https://github.com/loveflee/ha-mppt-modbus-addon"
arch:
  - amd64
  - armv7
  - aarch64
startup: services          # è·Ÿéš¨ HA æœå‹™å•Ÿå‹•
boot: auto                 # HA é–‹æ©Ÿæ™‚è‡ªå‹•å•Ÿå‹•

# âœ… å¯ä»¥åœ¨ HA UI ä¿®æ”¹çš„åƒæ•¸ï¼ˆæœƒå¯«åˆ° /data/options.jsonï¼‰
options:
  modbus_host: "modbus_gateway_ip"   # ä¸²å£ä¼ºæœå™¨ / MPPT Modbus TCP Server IP
  modbus_port: 502                   # Modbus TCP port

  mqtt_host: "core-mosquitto"        # MQTT Brokerï¼ˆé€šå¸¸å°±æ˜¯ HA çš„ MQTT æ’ä»¶ï¼‰
  mqtt_port: 1883
  mqtt_username: "add new user in ha"
  mqtt_password: "only Local network can login"

  slave_ids: "1,2,3,4,5"             # è¦è¼ªè©¢çš„ MPPT Slave IDs (é€—è™Ÿåˆ†éš”å­—ä¸²)
  poll_interval_seconds: 20          # è¼ªè©¢ç¸½é€±æœŸç§’æ•¸
  device_delay_ms: 1000              # æ¯å°è¨­å‚™é–“éš”ï¼Œæ¯«ç§’

  node_id: "wifi01"                  # åœ¨ HA ä¸­ç•¶ä½œæ­¤ Node çš„è­˜åˆ¥
  module_name: "ampinvt_mppt"        # module åï¼Œæ–¹ä¾¿æœªä¾†æ“´å……

  latitude: 24.15                    # ä½ç½®ï¼Œç”¨æ–¼æ—¥å‡º/æ—¥è½ç­‰é‚è¼¯ï¼ˆå¦‚æœ‰ï¼‰
  longitude: 120.67

  timezone: "Asia/Taipei"            # ğŸ•’ æ–°å¢ï¼šæ™‚å€è¨­å®šï¼ˆæœƒå¥—ç”¨åˆ° TZï¼‰
  log_level: "INFO"                  # ğŸ“ æ–°å¢ï¼šlog ç­‰ç´šï¼ˆDEBUG/INFO/WARNING/ERRORï¼‰

# âœ… options å‹åˆ¥å®šç¾©ï¼ˆHA UI é©—è­‰ç”¨ï¼‰
schema:
  modbus_host: str
  modbus_port: int
  mqtt_host: str
  mqtt_port: int
  mqtt_username: str
  mqtt_password: str
  slave_ids: str
  poll_interval_seconds: int
  device_delay_ms: int
  node_id: str
  module_name: str
  latitude: float
  longitude: float
  timezone: str
  log_level: str

# ä¸ç”¨ environmentï¼Œrun.sh æœƒè‡ªå·±è®€ /data/options.json
map:
  - config:rw
  - share:rw
  - ssl:ro

ports: {}
